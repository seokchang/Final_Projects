<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="camp">

    <select id="selectAllNotice" parameterType="map" resultType="cn">
  		select * from (select rownum as rnum, n.*from(select * from camp_notice order by 1 desc)n) where rnum between #{start} and #{end}
    </select>
  
    <select id="selectCountNoitce" resultType="_int">
  		select count(*) from camp_notice
    </select>

	<select id="selectRoomInfo" parameterType="_int" resultType="cr">
		select 
			room_no as roomNo,
			camp_no as campNo,
			room_member as roomMember,
			room_name as roomName,
			room_price roomPrice
		from camproom where room_no=#{_parameter}
	</select>
	
	<select id="selectCampInfo" parameterType="_int" resultType="c">
		select
			camp_no as campNo,
			ceo_id as ceoId,
			camp_addr as campAddr,
			camp_name as campName,
			camp_site as campSite,
			camp_tel as campTel,
			camp_theme as campTheme, 
			camp_fac as campFac,
			camp_ctg as campCtg
		from camp where camp_no=#{_parameter}
	</select>
	
	<insert id="campRes" parameterType="map">
		insert into reservation values(reservation_seq.nextval,#{userNo},#{campNo},#{campRoomNo},#{resInTime},#{resOutTime},#{resInDate},#{resOutDate},#{resMember},#{resPrice},#{resMemo},1)                              
	</insert>
	
	<select id="selectUserPoint" parameterType="_int" resultType="cu">
		select 
			user_no as userNo,
			user_name as userName,
			user_point as userPoint,
			user_level as userLevel,
			user_id as userId
		from user_tbl where user_no=#{_parameter}
	</select>
	
	<update id="updateUserPoint" parameterType="map">
		update user_tbl set
			user_point = (user_point-#{userUsePoint})
		where user_no = #{userNo}
	</update>
	
	<select id="totalPoint" parameterType="_int" resultType="_int">
		select user_point from user_tbl where user_no=#{_parameter}
	</select>
	
	<insert id="insertPoint" parameterType="map">
		insert into point values(point_seq.nextval,#{userNo},null,null,null,#{totalPoint},#{userUsePoint},'예약 시 포인트 사용',to_char(sysdate,'yyyy-mm-dd'))
	</insert>
	
	<insert id="insertComment" parameterType="map">
		insert into review values(review_seq.nextval,#{userId},#{campNo},#{revContents},1,to_char(sysdate,'yyyy-mm-dd'),null,0)
	</insert>
	
	<select id="selectAllComment" resultType="rvo">
		select
			rev_no as revNo,
			user_id as userId,
			camp_no as campNo,
			rev_contents as revContents,
			rev_star as revStar,
			rev_date as revDate,
			rev_image as revImage,
			rev_heart as revHeart
		from review
	</select>
	
	
	
	
	
	
	
	
	
	
	
	
  
</mapper>
